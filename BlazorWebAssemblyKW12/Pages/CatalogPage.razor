@page "/CatalogPage"

@using BlazorWebAssemblyKW12.Data
@using Glory.Domain
@using System.Net.Http.Headers

@inject ICatalog _myCatalog;
@inject ICart _cart;
@* @inject HttpClient _client; *@
@inject IList<ProductDTO> _products;

<h3>
    Catalog
    <NavLink class="nav-link"
             href="addProductPage">+</NavLink>
</h3>

@* @foreach (Product prod in @_myCatalog.GetProducts(DateTime.Now.DayOfWeek, "Windows")) *@
@* { *@
@*     <p> *@
@*         <ProductComponent Product="prod"/> *@
@*         @{ _ref = "productpage/" + prod.Name; } *@
@*         <NavLink href=@_ref>Просмотр товара</NavLink> *@
@*         <button class="btn btn-outline-success" @onclick="() => _cart.AddProduct(prod)">Добавить в корзину</button> *@
@*     </p> *@
@* } *@

@foreach (var product in _products)
{
    <p>
        @product.Name стоимостью @product.Price $
    </p>
}


@code
{
    private string _ref;
    private IList<ProductDTO> ProductDtos;

    protected override async Task OnInitializedAsync()
    {
        //ProductDtos = await _client.GetFromJsonAsync<IList<ProductDTO>>("https://localhost:7001/products");
        //return base.OnInitializedAsync();
        //_client.DefaultRequestHeaders.Add("Access-Control-Allow-Origin", "http://localhost:5194");
        //var d = await _client.GetFromJsonAsync<IList<ProductDTO>>("http://localhost:5194/products");
        //var s = await _client.GetStringAsync("http://localhost:5194/p2");
    }
}